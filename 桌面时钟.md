# 桌面时钟

## 概述

时间显示与同步：ESP32通过NTP同步时间，STM32显示在1.3寸I2C OLED。

联网查询天气：ESP32调用天气API，数据通过UART传到STM32，显示在OLED。

测量温湿度：STM32读取AHT10传感器数据，显示在OLED。

聊天功能：语音聊天（INMP441麦克风+MAX98357A功放+喇叭）。

## 硬件清单

- 开发板/芯片：

    - ESP32-S3-WROOM-1

    - STM32F103C8T6


- 显示屏：1.3寸OLED（128x64，I2C）

- 传感器：AHT10（温湿度，I2C）。

- 数字麦克风：INMP441。

- 功放：MAX98357A

- 腔体喇叭：8Ω 2-3W。

- 按键：6x6mm轻触开关（2脚直插，4个，菜单导航/文本输入）。

- 电源管理：

    - AMS1117-3.3V（SOT-223，3.3V稳压，供ESP32/STM32/OLED/AHT10/INMP441）。

    - AMS1117-5.0V（SOT-223，5V稳压，供ML307R/MAX98357A）。

    - 3.7V锂电池（可充电）。

    - DC-DC升压模块（3.7V升5V，供MAX98357A/ML307R）。


- 其他：

    - 电阻

    - 电容

    - 晶振

    - Type-C接口

    - 2.54mm排针/母

    - LED


## 功能实现

### 1. 时间显示与同步

- 功能：ESP32通过NTP同步时间，写入STM32的RTC，STM32显示在1.3寸OLED。
- 实现步骤

    1. ESP32配置Wi-Fi，同步NTP。
    2. 每隔一段时间，UART发送到STM32，同步到RTC。
    3. STM32显示数字时钟

### 2. 联网查询天气

- 功能：ESP32调用天气API，数据通过UART传到STM32，显示在OLED。
- 实现步骤

    1. ESP32配置Wi-Fi
    2. 调用天气API，解析温度、湿度、天气状况。
    3. 格式化JSON，UART发送。
    4. STM32显示

### 3. 测量温湿度

- 功能：STM32读取AHT10数据，显示在1.3寸OLED
- 实现步骤

    1. STM32初始化I2C（PB6/SCL，PB7/SDA）。
2. 每5秒读取AHT10温湿度，显示在OLED

### 4. 聊天功能

- 功能：语音聊天（INMP441输入，MAX98357A输出）。
- 实现步骤：ESP32配置读取INMP441语音，上传云端API，MAX98357A播放回复，参考小智。


## 电路设计

做两块板子，第一块是ESP32的，第二块是STM32的